<div class="widgets">
    <div class="row">
        <div class="col-lg-12 col-md-12">
            <div baCardBlur class="animated fadeIn card with-scroll" zoom-in>
                <div class="card-header clearfix">
                    <div class="card-title">
                        Contact Records
                    </div>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="horizontal-scroll">
                                <table class="table table-hover">
                                    <thead>
                                        <tr class="black-muted-bg">
                                            <th>#</th>
                                            <th>Date</th>
                                            <th>Time</th>
                                            <th>Customer Comment</th>
                                            <th>Executive Name</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let info of record.contact_info; let i=index;">
                                            <td>{{ (currentPage - 1) * 5 + (i + 1)}}</td>
                                            <td>{{info.called_at | date: 'dd MMM-yyyy'}}</td>
                                            <td>{{info.called_at | date: 'hh:mm'}}</td>
                                            <td>{{info.comment}}</td>
                                            <td>{{info.customer_executive}}</td>
                                        </tr>
                                    </tbody>
                                </table>
                                <pagination [totalItems]="totalItems" [(ngModel)]="currentPage" [maxSize]="maxSize" [rotate]="false" previousText="&lsaquo;"
                                    nextText="&rsaquo;" firstText="&laquo;" lastText="&raquo;" class="pagination-sm" [boundaryLinks]="true"
                                    (click)="setPage()">
                                </pagination>
                            </div>
                        </div>
                    </div>
                    <hr>
                    <div class="row">
                        <div class="col-md-6">
                            <div baCardBlur class="animated fadeIn card with-scroll" zoom-in>
                                <div class="card-header clearfix">
                                    <div class="card-title">
                                        Customer Information
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div *ngIf="!is_new_customer" class="horizontal-scroll info-table">
                                        <table class="table table-hover">
                                            <tbody>
                                                <tr *ngIf="record.name && record.name!='anonymous'">
                                                    <td>Name</td>
                                                    <td>:</td>
                                                    <td>
                                                        {{record.name}}
                                                    </td>
                                                </tr>
                                                <tr *ngIf="record.phone_number">
                                                    <td>Mobile</td>
                                                    <td>:</td>
                                                    <td>
                                                        {{record.phone_number}}
                                                    </td>
                                                </tr>
                                                <tr *ngIf="record.email">
                                                    <td>Email</td>
                                                    <td>:</td>
                                                    <td>
                                                        {{record.email}}
                                                    </td>
                                                </tr>
                                                <tr *ngIf="record.address">
                                                    <td>Address</td>
                                                    <td>:</td>
                                                    <td>
                                                        {{record.address}} , {{record.thana}}, {{record.district}}
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <div *ngIf="is_new_customer">
                                        <div class="form-group row">
                                            <label for="contact-name" class="col-md-4 control-label"> Contact Name
                                                <span style="color:red">*</span>
                                            </label>
                                            <div class="col-md-8">
                                                <input type="text" [(ngModel)]="record.name" class="form-control" name="contact_name" placeholder="Customer Name">
                                            </div>
                                        </div>
                                    </div>
                                    <br>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div baCardBlur class="animated fadeIn card with-scroll" zoom-in>
                                <div class="card-header clearfix">
                                    <div class="card-title">
                                        Operation
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div class="form-group row">
                                        <label for="query_type" class="col-md-4 control-label"> Query Type: </label>
                                        <div class="col-md-8">
                                            <select class="form-control" [(ngModel)]="record.query_type" name="query_type" (change)="openQueryModal(record.query_type)">
                                                <option *ngFor="let q_type of query_types" [ngValue]="q_type.value">
                                                    {{q_type.name}}
                                                </option>
                                            </select>
                                        </div>
                                    </div>
                                    <div *ngIf="otherOperation" class="form-group row">
                                        <label for="comment" class="col-md-4 control-label"> Comment
                                            <span style="color:red">*</span>
                                        </label>
                                        <div class="col-md-8">
                                            <textarea [(ngModel)]="record.comment" class="form-control" name="comment" placeholder="Comment..."></textarea>
                                            <span *ngIf="submitted && !record.comment" style="color: red">Comment is required.</span>
                                        </div>
                                    </div>
                                    <div *ngIf="otherOperation" class="row">
                                        <div class="col-md-6">
                                            <div *ngFor="let alert of alerts">
                                                <alert [type]="alert.type" [dismissOnTimeout]="alert.timeout">{{ alert.msg }}</alert>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <spinner *ngIf="res_pending" [tickness]="1" [size]="20"></spinner>
                                            <button (click)="saveRecord('notModal')" class="btn btn-default pull-right">Submit</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div bsModal #orderCreateModal="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="orderCreateModal"
        aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" (click)="cancel('orderCreateModal')">&times;</button>
                    <h4 class="modal-title">New Book Order</h4>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-12">
                            <tabset type="pills">
                                <tab heading="Shipping Address" id="tab1">
                                    <div class="row ">
                                        <div class="col-md-12">
                                            <ba-card>
                                                <form class="form-horizontal place-order-13" (ngSubmit)="saveAddress()">
                                                    <div class="form-group row">
                                                        <label for="contact-name" class="col-md-4 control-label"> Contact Name
                                                            <span style="color:red">*</span>
                                                        </label>
                                                        <div class="col-md-8">
                                                            <input type="text" [(ngModel)]="shipping.contact_name" class="form-control" name="contact_name" id="contact_name" placeholder="Contact Name">
                                                        </div>
                                                    </div>

                                                    <div class="form-group row">
                                                        <label for="district" class="col-md-4 control-label"> District
                                                            <span style="color:red">*</span>
                                                        </label>
                                                        <div class="col-md-8">
                                                            <select name="district" class="form-control" [(ngModel)]="shipping.district" (change)="selectDistrict(shipping.district)"
                                                                required>
                                                                <option *ngFor="let district of districts" [ngValue]="district.DISTRICTT_NAME">
                                                                    {{district.DISTRICTT_NAME}}
                                                                </option>
                                                            </select>
                                                        </div>
                                                    </div>

                                                    <div class="form-group row">
                                                        <label for="thana" class="col-md-4 control-label">Thana
                                                            <span style="color:red">*</span>
                                                        </label>
                                                        <div class="col-md-8">
                                                            <select name="thana" class="form-control" [(ngModel)]="shipping.thana" required>
                                                                <option *ngFor="let thana of thanas" [ngValue]="thana.THANA_NAME">
                                                                    {{thana.THANA_NAME}}
                                                                </option>
                                                            </select>
                                                        </div>
                                                    </div>

                                                    <div class="form-group row">
                                                        <label for="address" class="col-md-4 control-label"> Address
                                                            <span style="color:red">*</span>
                                                        </label>
                                                        <div class="col-md-8">
                                                            <textarea [(ngModel)]="shipping.address" name="address" class="form-control" placeholder="Address"></textarea>
                                                        </div>
                                                    </div>

                                                    <div class="form-group row">
                                                        <label for="phone-number" class="col-md-4 control-label"> Phone Number
                                                            <span style="color:red">*</span>
                                                        </label>
                                                        <div class="col-md-8">
                                                            <input type="text" [(ngModel)]="shipping.phone_number" name="phone_number" class="form-control" placeholder="Phone Number"
                                                                maxlength="11">
                                                        </div>
                                                    </div>
                                                    <div class="form-group row">
                                                        <label for="alt_phone-number" class="col-md-4 control-label"> Alternate Number
                                                            <span style="color:red">*</span>
                                                        </label>
                                                        <div class="col-md-8">
                                                            <input type="text" [(ngModel)]="shipping.alter_phone" name="alt_phone_number" class="form-control" placeholder="Alternate Number">
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-md-6">
                                                            <div *ngFor="let alert of alerts">
                                                                <alert [type]="alert.type" [dismissOnTimeout]="alert.timeout">{{ alert.msg }}</alert>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-6">
                                                            <button type="submit" class="btn btn-default pull-right">Ok</button>
                                                        </div>
                                                    </div>
                                                </form>
                                            </ba-card>
                                        </div>
                                    </div>
                                </tab>
                                <tab heading="Search Product" id="tab2" [active]="isSavedAddress">
                                    <div class="row ">
                                        <div class="col-md-12">
                                            <ba-card title="Select Product">
                                                <div class="form-group row">
                                                    <div class="col-md-8">
                                                        <search-typeahead [clearField]="isClear" [items]="dataList" [image]="show_image" (dataLoader)="getData($event)" (selectedLoader)="getSelected($event)"></search-typeahead>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <button class="btn btn-default" style="padding: 8px;" (click)="addItemToList()">
                                                            <i class="fa fa-plus-circle plus-icon">&nbsp;&nbsp;Add</i>
                                                        </button>
                                                    </div>
                                                </div>

                                                <div *ngIf="selectedItems.length>0" class="horizontal-scroll">
                                                    <h3>Item List:</h3>
                                                    <table class="table table-hover">
                                                        <tbody>
                                                            <tr class="black-muted-bg">
                                                                <td class="table-id" width="3%">#</td>
                                                                <td width="12%">Image</td>
                                                                <td width="40%">Name</td>
                                                                <td width="15%">Qty</td>
                                                                <td width="15%">Rate</td>
                                                                <td width="5%">Total</td>
                                                                <td width="5%">Edit</td>
                                                                <td width="5%">Remove</td>
                                                            </tr>
                                                            <tr *ngFor="let item of selectedItems; let i=index">
                                                                <td>{{i + 1}}</td>
                                                                <td (click)="viewImage(item)">
                                                                    <img style="width: 50px; height: 48px; border-radius: 57%; border-style: none;" src="{{item.item_image}}" onerror="this.src='assets/img/theme/book-no-photo.jpg';"
                                                                        alt="">
                                                                </td>
                                                                <td>{{item.item_name}}</td>
                                                                <td>
                                                                    <span *ngIf="!item.is_edit">{{item.item_qty}}</span>
                                                                    <input (change)="updateTotalCost()" class="form-control" *ngIf="item.is_edit" [(ngModel)]="item.item_qty" type="number">
                                                                </td>
                                                                <td>
                                                                    <span *ngIf="!item.is_edit">{{item.item_rate}}</span>
                                                                    <input (change)="updateTotalCost()" class="form-control" [(ngModel)]="item.item_rate" *ngIf="item.is_edit" type="number">
                                                                </td>
                                                                <td>{{item.item_qty * item.item_rate}}</td>
                                                                <td>
                                                                    <i *ngIf="!item.is_edit" (click)="edit(item, i)" class="fa fa-pencil-square-o change-ico"></i>
                                                                    <i *ngIf="item.is_edit" (click)="edited(item, i)" class="fa fa-plus-square change-ico" aria-hidden="true"></i>
                                                                </td>
                                                                <td>
                                                                    <i (click)="remove(item, i)" class="fa fa-trash change-ico" aria-hidden="true"></i>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td colspan="5"></td>
                                                                <td colspan="3">Total Cost: {{total_cost}}</td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                    <form class="form-horizontal place-order-13" (ngSubmit)="submitOrder()">
                                                        <ba-card title="Charges" baCardClass="with-scroll heading-widget">
                                                            <div class="form-group row">
                                                                <label for="shipping_charge" class="col-md-4 control-label"> Shipping Charge(TK.): </label>
                                                                <div class="col-md-8">
                                                                    <input type="number" [(ngModel)]="order.delivery_charge" class="form-control" name="shipping_charge" id="shipping_charge"
                                                                        placeholder="Shipping Charge">
                                                                </div>
                                                            </div>
                                                            <div class="form-group row">
                                                                <label for="discount" class="col-md-4 control-label"> Discount(TK.): </label>
                                                                <div class="col-md-8">
                                                                    <input type="number" [(ngModel)]="order.discount" class="form-control" name="discount" placeholder="Discount">
                                                                </div>
                                                            </div>
                                                            <div class="form-group row">
                                                                <label for="wrapping_charge" class="col-md-4 control-label"> Wrapping Charge(TK.): </label>
                                                                <div class="col-md-8">
                                                                    <input type="number" [(ngModel)]="order.wrapping_charge" class="form-control" name="wrapping_charge" placeholder="Wrapping Charge">
                                                                </div>
                                                            </div>
                                                            <div class="form-group row">
                                                                <label for="wrapping_charge" class="col-md-4 control-label"></label>
                                                                <div class="col-md-8">
                                                                    <h5>Summary: {{total_cost+order.delivery_charge+order.wrapping_charge-order.discount}}
                                                                        TK.
                                                                    </h5>
                                                                </div>
                                                            </div>
                                                        </ba-card>
                                                        <br>
                                                        <div class="row">
                                                            <div class="col-md-6">
                                                                <div *ngFor="let alert of alerts">
                                                                    <alert [type]="alert.type" [dismissOnTimeout]="alert.timeout">{{ alert.msg }}</alert>
                                                                </div>
                                                            </div>
                                                            <div class="col-md-6">
                                                                <button class="btn btn-default pull-right">Submit</button>
                                                            </div>
                                                        </div>
                                                    </form>
                                                </div>
                                            </ba-card>
                                        </div>
                                    </div>
                                </tab>
                            </tabset>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div bsModal #existBookOrderModal="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="existBookOrderModal"
        aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" (click)="cancel('existBookOrderModal')">&times;</button>
                    <h4 class="modal-title">Exist Book Order</h4>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group row">
                                <label for="order" class="col-md-4 control-label">Select Order: </label>
                                <div class="col-md-8">
                                    <select class="form-control" [(ngModel)]="selectedOrder" name="order">
                                        <option *ngFor="let order of exist_orders; let i=index" [ngValue]="order">
                                            {{order.order_no}}
                                        </option>
                                    </select>
                                </div>
                            </div>
                            <div *ngIf="selectedOrder._id" baCardBlur class="animated fadeIn card with-scroll" zoom-in>
                                <div class="card-header clearfix">
                                    <div class="card-title">
                                        Order Info
                                    </div>
                                </div>
                                <div class="card-body">
                                    <h4>Status: {{selectedOrder.current_order_status?.status_name}}</h4>
                                    <hr>
                                    <div class="horizontal-scroll info-table">
                                        <table class="table table-hover">
                                            <tbody>
                                                <tr>
                                                    <td>Name</td>
                                                    <td>:</td>
                                                    <td>
                                                        {{selectedOrder.delivery_address?.contact_name}}
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>Mobile</td>
                                                    <td>:</td>
                                                    <td>
                                                        {{selectedOrder.delivery_address?.phone_number}}
                                                    </td>
                                                </tr>
                                                <tr *ngIf="selectedOrder.created_by && selectedOrder.created_by.email">
                                                    <td>Email</td>
                                                    <td>:</td>
                                                    <td>
                                                        {{selectedOrder.created_by?.email}}
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>Address</td>
                                                    <td>:</td>
                                                    <td>
                                                        {{selectedOrder.delivery_address?.address}}, {{selectedOrder.delivery_address?.thana}}, {{selectedOrder.delivery_address?.district}}
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            <div *ngIf="selectedOrder.products" class="row">
                                <div class="col-md-12">
                                    <div baCardBlur class="animated fadeIn card with-scroll" zoom-in>
                                        <div class="card-header clearfix">
                                            <div class="card-title">
                                                Order Items
                                            </div>
                                        </div>
                                        <div class="card-body">
                                            <div class="horizontal-scroll">
                                                <table class="table table-hover">
                                                    <thead>
                                                        <tr>
                                                            <th>SL#</th>
                                                            <th> Product Name </th>
                                                            <th> Publisher Name </th>
                                                            <th> QTY </th>
                                                            <th> Unit Price </th>
                                                            <th>Total Price</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody class="product-body">
                                                        <tr *ngFor="let item of selectedOrder.products; let i=index">
                                                            <td>{{i+1}}</td>
                                                            <td>{{item.name}}</td>
                                                            <td>{{item.publisher}}</td>
                                                            <td>{{item.quantity}}</td>
                                                            <td>{{item.price}}</td>
                                                            <td>BDT {{item.price * item.quantity}}</td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div *ngIf="selectedOrder._id" class="row">
                                <div class="col-md-6">
                                    <div baCardBlur class="animated fadeIn card with-scroll" zoom-in>
                                        <div class="card-header clearfix">
                                            <div class="card-title">
                                                Order Charges
                                            </div>
                                        </div>
                                        <div class="card-body">
                                            <div class="horizontal-scroll info-table">
                                                <table class="table table-hover">
                                                    <tbody>
                                                        <tr>
                                                            <td style="text-align:left;">Item Price</td>
                                                            <td>:</td>
                                                            <td>
                                                                {{selectedOrder.total_price}} Tk.
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="text-align:left;">Delivery Charge</td>
                                                            <td>:</td>
                                                            <td>
                                                                {{selectedOrder.delivery_charge}} Tk.
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="text-align:left;">Wrapping Charge</td>
                                                            <td>:</td>
                                                            <td>
                                                                {{selectedOrder.wrapping_charge}} Tk.
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="text-align:left;">Discount</td>
                                                            <td>:</td>
                                                            <td>
                                                                {{selectedOrder.discount}} Tk.
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="text-align:left;">
                                                                <b>Payble Amount</b>
                                                            </td>
                                                            <td>:</td>
                                                            <td>
                                                                <b>
                                                                    {{selectedOrder.total_price+selectedOrder.delivery_charge+selectedOrder.wrapping_charge-selectedOrder.discount}} Tk.
                                                                </b>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div baCardBlur class="animated fadeIn card with-scroll" zoom-in>
                                        <div class="card-header clearfix">
                                            <div class="card-title">
                                                Payment Info
                                            </div>
                                        </div>
                                        <div class="card-body">
                                            <div class="horizontal-scroll info-table">
                                                <table class="table table-hover">
                                                    <tbody>
                                                        <tr>
                                                            <td>Paid</td>
                                                            <td>:</td>
                                                            <td>
                                                                {{selectedOrder.payment_collection?.total_paid}}
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td>Due Amount</td>
                                                            <td>:</td>
                                                            <td>
                                                                {{selectedOrder.payable_amount-selectedOrder.payment_collection?.total_paid}}
                                                            </td>
                                                        </tr>
                                                        <tr *ngIf="selectedOrder.payment_information">
                                                            <td>Transaction Date</td>
                                                            <td>:</td>
                                                            <td>
                                                                {{selectedOrder.payment_information.tran_date | date: 'dd MMM-yyyy'}}
                                                            </td>
                                                        </tr>
                                                        <tr *ngIf="selectedOrder.payment_information && selectedOrder.payment_information.status=='VALID'">
                                                            <td>Payment Type</td>
                                                            <td>:</td>
                                                            <td>
                                                                {{selectedOrder.payment_information.card_brand}}, {{selectedOrder.payment_information.card_issuer}}
                                                            </td>
                                                        </tr>
                                                        <tr *ngIf="selectedOrder.payment_information && selectedOrder.payment_information.status=='VALID'">
                                                            <td>Paid Amount</td>
                                                            <td>:</td>
                                                            <td>
                                                                {{selectedOrder.payment_information.currency_amount}} TK.
                                                            </td>
                                                        </tr>
                                                        <tr *ngIf="selectedOrder.payment_information && selectedOrder.payment_information.status=='VALID'">
                                                            <td>Status</td>
                                                            <td>:</td>
                                                            <td>
                                                                {{selectedOrder.payment_information.status}}
                                                            </td>
                                                        </tr>
                                                        <tr *ngIf="selectedOrder.payment_information && selectedOrder.payment_information.status!='VALID'">
                                                            <td>Payment Status</td>
                                                            <td>:</td>
                                                            <td>
                                                                {{selectedOrder.payment_information.status}}
                                                            </td>
                                                        </tr>
                                                        <tr *ngIf="selectedOrder.payment_information && selectedOrder.payment_information.status!='VALID'">
                                                            <td>Message</td>
                                                            <td>:</td>
                                                            <td>
                                                                {{selectedOrder.payment_information.message}}
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div *ngIf="selectedOrder._id" class="row">
                        <ba-card>
                            <form (ngSubmit)="saveRecord('existBookOrderModal')">
                                <div class="form-group row">
                                    <label for="comment" class="col-md-4 control-label"> Comment
                                        <span style="color:red">*</span>
                                    </label>
                                    <div class="col-md-8">
                                        <textarea [(ngModel)]="record.comment" class="form-control" name="comment" placeholder="Comment..."></textarea>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6 pull-left">
                                        <button class="btn btn-default">Submit</button>
                                    </div>
                                    <div class="col-md-6">
                                        <div *ngFor="let alert of alerts">
                                            <alert [type]="alert.type" [dismissOnTimeout]="alert.timeout">{{ alert.msg }}</alert>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </ba-card>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div bsModal #paymentModalModal="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="paymentModalModal"
        aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" (click)="cancel('paymentModalModal')">&times;</button>
                    <h4 class="modal-title">Payment Issue</h4>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group row">
                                <label for="order" class="col-md-4 control-label">Select Order: </label>
                                <div class="col-md-8">
                                    <select class="form-control" [(ngModel)]="selectedOrder" name="order">
                                        <option *ngFor="let order of exist_orders; let i=index" [ngValue]="order">
                                            {{order.order_no}}
                                        </option>
                                    </select>
                                </div>
                            </div>

                            <div class="row" *ngIf="selectedOrder._id">
                                <div class="col-md-6">
                                    <div baCardBlur class="animated fadeIn card with-scroll" zoom-in>
                                        <div class="card-header clearfix">
                                            <div class="card-title">
                                                Order Charges
                                            </div>
                                        </div>
                                        <div class="card-body">
                                            <div class="horizontal-scroll info-table">
                                                <table class="table table-hover">
                                                    <tbody>
                                                        <tr>
                                                            <td style="text-align:left;">Item Price</td>
                                                            <td>:</td>
                                                            <td>
                                                                {{selectedOrder.total_price}} Tk.
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="text-align:left;">Delivery Charge</td>
                                                            <td>:</td>
                                                            <td>
                                                                {{selectedOrder.delivery_charge}} Tk.
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="text-align:left;">Wrapping Charge</td>
                                                            <td>:</td>
                                                            <td>
                                                                {{selectedOrder.wrapping_charge}} Tk.
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="text-align:left;">Discount</td>
                                                            <td>:</td>
                                                            <td>
                                                                {{selectedOrder.discount}} Tk.
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="text-align:left;">
                                                                <b>Payble Amount</b>
                                                            </td>
                                                            <td>:</td>
                                                            <td>
                                                                <b>
                                                                    {{selectedOrder.total_price+selectedOrder.delivery_charge+selectedOrder.wrapping_charge-selectedOrder.discount}} Tk.
                                                                </b>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="text-align:left;">
                                                                Paid Amount
                                                            </td>
                                                            <td>:</td>
                                                            <td>
                                                                {{selectedOrder.payment_collection?.total_paid}} Tk.
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="text-align:left;">
                                                                <b>Due Amount</b>
                                                            </td>
                                                            <td>:</td>
                                                            <td>
                                                                <b>
                                                                    {{selectedOrder.payable_amount-selectedOrder.payment_collection.total_paid}} Tk.
                                                                </b>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div baCardBlur class="animated fadeIn card with-scroll" zoom-in>
                                        <div class="card-header clearfix">
                                            <div class="card-title">
                                                Required Data
                                            </div>
                                        </div>
                                        <div class="card-body">
                                            <div class="horizontal-scroll info-table">
                                                <form>
                                                    <div class="form-group row">
                                                        <label for="carrier_name" class="col-md-4 control-label"> Select Carrier: </label>
                                                        <div class="col-md-8">
                                                            <select [(ngModel)]="cust_pay_info.carrier_id" class="form-control" name="carrier_name" id="carrier_name">
                                                                <option *ngFor="let carry of carriers" [ngValue]="carry._id">
                                                                    {{carry.name}}
                                                                </option>
                                                            </select>
                                                            <span *ngIf="submitted && !cust_pay_info.carrier_id" style="color: red">Carrier name is required!</span>
                                                        </div>
                                                    </div>
                                                    <div class="form-group row">
                                                        <label for="gateway_id" class="col-md-4 control-label"> Payment Gateway : </label>
                                                        <div class="col-md-8">
                                                            <select [(ngModel)]="cust_pay_info.gateway_id" class="form-control" name="gateway_id" id="gateway_id">
                                                                <option *ngFor="let gateway of payementGatewayes" [ngValue]="gateway._id">
                                                                    {{gateway.name}}
                                                                </option>
                                                            </select>
                                                            <span *ngIf="submitted && !cust_pay_info.gateway_id" style="color: red">Payment gateway required!</span>
                                                        </div>
                                                    </div>
                                                    <div class="form-group row">
                                                        <label for="gateway_id" class="col-md-4 control-label"> Pay Amount : </label>
                                                        <div class="col-md-8">
                                                            <input type="number" name="pay_amount" [(ngModel)]="cust_pay_info.pay_amount" class="form-control" placeholder="Pay Amount">
                                                            <span *ngIf="submitted && !cust_pay_info.pay_amount" style="color: red">Pay amount required!</span>
                                                        </div>
                                                    </div>
                                                    <div>
                                                        <div class="row">
                                                            <div class="col-md-6">
                                                                <div *ngFor="let alert of alerts">
                                                                    <alert [type]="alert.type" [dismissOnTimeout]="alert.timeout">{{ alert.msg }}</alert>
                                                                </div>
                                                            </div>
                                                            <div class="col-md-6">
                                                                <button [disabled]="(selectedOrder.payable_amount-selectedOrder.payment_collection.total_paid)<1 || (selectedOrder.payable_amount-selectedOrder.payment_collection.total_paid)<cust_pay_info.pay_amount"
                                                                    (click)="collectCustomePayment()" class="btn btn-default">Submit</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div bsModal #bookQueryModal="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="bookQueryModal" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" (click)="cancel('bookQueryModal')">&times;</button>
                    <h4 class="modal-title">Query for Book</h4>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-12">
                            <form class="form-horizontal place-order" (ngSubmit)="submitQuery(query, 'bookQueryModal')">
                                <div class="form-group row">
                                    <label for="contact-name" class="col-md-4 control-label"> Name
                                        <span style="color: red; font-size: 15px">*</span>
                                    </label>
                                    <div class="col-md-8">
                                        <input type="text" [(ngModel)]="query.name" (ngModelChange)="validate('name')" class="form-control" name="name" id="name"
                                            placeholder="Name" required>
                                        <span *ngIf="validation.name?.required_error" style="color:red;" class="help-block sub-little-text">Name is required</span>
                                        <span *ngIf="validation.name?.length_error" style="color:red;" class="help-block sub-little-text">Name should be minimum 4 characters</span>
                                    </div>
                                </div>

                                <div class="form-group row">
                                    <label for="contact-name" class="col-md-4 control-label"> Book
                                        <span style="color: red; font-size: 15px">*</span>
                                    </label>
                                    <div class="col-md-8">
                                        <input type="text" [(ngModel)]="query.book" (ngModelChange)="validate('book')" class="form-control" name="name" id="book"
                                            placeholder="Book" required>
                                        <span *ngIf="validation.book?.required_error" style="color:red;" class="help-block sub-little-text">Book name is required</span>
                                    </div>
                                </div>

                                <div class="form-group row">
                                    <label for="contact-name" class="col-md-4 control-label">Book Author</label>
                                    <div class="col-md-8">
                                        <input type="text" [(ngModel)]="query.author" class="form-control" name="name" id="author" placeholder="Book Author">
                                    </div>
                                </div>

                                <div class="form-group row">
                                    <label for="message" class="col-md-4 control-label">
                                        Comment
                                        <span style="color: red; font-size: 15px">*</span>
                                    </label>
                                    <div class="col-md-8">
                                        <textarea [(ngModel)]="query.message" (ngModelChange)="validate('message')" name="message" class="form-control" placeholder="Comment">

                                        </textarea>
                                        <span *ngIf="validation.message?.required_error" style="color:red;" class="help-block sub-little-text">Comment is required</span>
                                    </div>
                                </div>

                                <div class="form-group row">
                                    <label for="altphone" class="col-md-4 control-label"> </label>
                                    <div class="col-md-8">
                                        <button [disabled]="validation.message?.required_error || !query.message  || validation.book?.required_error || !query.name || validation.name?.length_error"
                                            type="submit" class="btn btn-default comment-button">Submit Query</button>
                                            <br><br>
                                        <div *ngFor="let alert of alerts">
                                            <alert [type]="alert.type" [dismissOnTimeout]="alert.timeout">{{ alert.msg }}</alert>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>